(()=>{firebase.initializeApp({apiKey:"AIzaSyBFnHlWuc5pR9NxAvUVZkeFORIZor1lmrs",authDomain:"notenmanager-c2a2e.firebaseapp.com",databaseURL:"https://notenmanager-c2a2e-default-rtdb.firebaseio.com",projectId:"notenmanager-c2a2e",storageBucket:"notenmanager-c2a2e.appspot.com",messagingSenderId:"21273119934",appId:"1:21273119934:web:8448400bde5c124f1aa2ef",measurementId:"G-Q7YMZ047F0"});let e={},t={},n={},o="",a=[],c=null;class s{loadSubjects(t,n){firebase.database().ref("/users/"+n+"/subjects").once("value",(n=>{n.forEach((t=>{const n=t.val(),o=t.key;e[o]||(e[o]=[]),e[o].push({id:o,name:n.name,color:n.color,action:"get"})})),t&&"function"==typeof t&&t()}))}loadCategories(e,n){firebase.database().ref("/users/"+n+"/categories").once("value",(n=>{n.forEach((e=>{const n=e.val(),o=e.key;t[o]||(t[o]=[]),t[o].push({id:o,name:n.name,weight:n.weight,subjectId:n.subjectId,action:"get"})})),e&&"function"==typeof e&&e()}))}loadGrades(e,t){firebase.database().ref("/users/"+t+"/grades").once("value",(t=>{t.forEach((e=>{const t=e.val(),o=e.key;n[o]||(n[o]=[]),n[o].push({id:o,name:t.name,value:t.value,date:t.date,subjectId:t.subjectId,categoryId:t.categoryId,action:"get"})})),e&&"function"==typeof e&&e()}))}}class d{pushSubjects(t){const n=firebase.database().ref("/users/"+t+"/subjects");Object.values(e).forEach((t=>{t.forEach((t=>{if("push"===t.action){const o=n.push();o.set({name:t.name,color:t.color}),o.then((n=>{const o=n.key;e[o]=[{id:o,name:t.name,color:t.color,action:"get"}],delete e[t.id],E(t.name,t.color,o)}))}else"overwrite"===t.action?(n.child(t.id).update({name:t.name,color:t.color}),t.action="get"):"delete"===t.action&&(this.deleteCategoriesAndGradesBySubjectId(t.id),n.child(t.id).remove().then((()=>{e[t.id]&&delete e[t.id];const n=document.getElementById("noSubjectMessage");0===Object.keys(e).length?n.style.display="block":n.style.display="none"})),t.action="get")}))}))}pushCategories(e){const n=firebase.database().ref("/users/"+e+"/categories");Object.values(t).forEach((e=>{e.forEach((e=>{if("push"===e.action){const o=n.push();o.set({name:e.name,weight:e.weight,subjectId:e.subjectId}),o.then((n=>{const o=n.key;t[o]=[{id:o,name:e.name,weight:e.weight,subjectId:e.subjectId,action:"get"}],delete t[e.id],b(e.name,e.weight,o,e.subjectId)}))}else"overwrite"===e.action?(n.child(e.id).update({name:e.name,weight:e.weight}),e.action="get"):"delete"===e.action&&(this.deleteGradesByCategoryId(e.id),n.child(e.id).remove().then((()=>{t[e.id]&&delete t[e.id]})),e.action="get")}))}))}pushGrades(e){const t=firebase.database().ref("/users/"+e+"/grades");Object.values(n).forEach((e=>{e.forEach((e=>{if("push"===e.action){const o=t.push();o.set({value:e.value,date:e.date,subjectId:e.subjectId,categoryId:e.categoryId}),o.then((t=>{const o=t.key;n[o]=[{id:o,value:e.value,date:e.date,subjectId:e.subjectId,categoryId:e.categoryId,action:"get"}],delete n[e.id],v(e.value,e.date,e.categoryId,o)}))}else"overwrite"===e.action?(t.child(e.id).update({value:e.value,date:e.date}),subject.action="get"):"delete"===e.action&&(t.child(e.id).remove().then((()=>{n[e.id]&&delete n[e.id]})),e.action="get")}))}))}deleteCategoriesAndGradesBySubjectId(e){Object.keys(t).forEach((n=>{const o=t[n];o.forEach(((t,a)=>{t.subjectId===e&&(this.deleteGradesByCategoryId(t.id),firebase.database().ref("/users/"+c+`/categories/${n}`).remove(),o.splice(a,1))})),0===o.length&&delete t[n]}))}deleteGradesByCategoryId(e){Object.keys(n).forEach((t=>{const o=n[t];o.forEach(((n,a)=>{n.categoryId===e&&(firebase.database().ref("/users/"+c+`/grades/${t}`).remove(),o.splice(a,1))})),0===o.length&&delete n[t]}))}}function i(){var e=new firebase.auth.GoogleAuthProvider;firebase.auth().signInWithPopup(e).then((function(e){})).catch((function(e){var t=e.code,n=e.message,o=e.email,a=e.credential;console.error("Authentifizierungsfehler",t,n,o,a)}))}function u(){confirm("Möchten Sie sich wirklich abmelden?")&&firebase.auth().signOut().then((function(){c=null,console.log("Abmeldung erfolgreich"),t={},n={},e={},C()})).catch((function(e){console.error("Fehler beim Abmelden",e)}))}function l(e){(e=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))).setUTCDate(e.getUTCDate()+4-(e.getUTCDay()||7));const t=new Date(Date.UTC(e.getUTCFullYear(),0,1)),n=Math.ceil(((e-t)/864e5+1)/7);return e.getUTCFullYear().toString().substring(2)+"-W"+n.toString().padStart(2,"0")}function r(e,t){let n=parseInt(e.slice(1,3),16),o=parseInt(e.slice(3,5),16),a=parseInt(e.slice(5,7),16);return t?`rgba(${n}, ${o}, ${a}, ${t})`:`rgb(${n}, ${o}, ${a})`}function m(e,t){e.textContent!==t&&(e.style.opacity="0",e.style.transform="translateY(-10px)",setTimeout((()=>{e.textContent=t,e.style.opacity="1",e.style.transform="translateY(0)"}),300))}function g(){const e=function(){const e=[];Object.values(n).forEach((t=>{t.forEach((t=>{e.push({value:parseFloat(t.value),week:l(new Date(t.date))})}))}));const t=e.reduce(((e,t)=>(e[t.week]=e[t.week]||[],e[t.week].push(t.value),e)),{}),o=Object.entries(t).map((([e,t])=>({x:e,y:(t.reduce(((e,t)=>e+t),0)/t.length).toFixed(1)})));return o.sort(((e,t)=>e.x.localeCompare(t.x))),o}(),t=document.getElementById("gradeChart").getContext("2d");window.gradeChart instanceof Chart&&window.gradeChart.destroy(),window.gradeChart=new Chart(t,{type:"line",data:{labels:e.map((e=>e.x)),datasets:[{label:"Notedurchschnitt der Woche",data:e.map((e=>e.y)),backgroundColor:"rgba(54, 162, 235, 0.2)",borderColor:"rgba(54, 162, 235, 1)",borderWidth:1.3,fill:!1,pointRadius:3}]},options:{plugins:{legend:{display:!1}},animations:{tension:{duration:1e3,easing:"easeInOutQuart",from:.7,to:.25,loop:!1}},scales:{y:{beginAtZero:!1,reverse:!0,ticks:{stepSize:1,max:6,min:1}},x:{}},responsive:!0,maintainAspectRatio:!1}})}function p(){const t=function(){let t=[],n=0;return Object.values(e).forEach((e=>{e.forEach((e=>{const o=document.getElementById(e.id);if(o){const a=Number(o.getAttribute("data-subject-average"));0!==a&&(t.push({name:e.name,average:a,color:e.color}),n+=a)}}))})),t.map((e=>({name:e.name,weight:parseFloat((e.average/n*100).toFixed(2)),color:r(e.color,.3),borderColor:r(e.color,1)})))}(),n=document.getElementById("gradeDistributionChart"),o=n.getContext("2d");o.clearRect(0,0,n.width,n.height),window.gradeDistributionChart instanceof Chart&&window.gradeDistributionChart.destroy(),window.gradeDistributionChart=new Chart(o,{type:"polarArea",data:{labels:t.map((e=>e.name)),datasets:[{label:"Fach",data:t.map((e=>e.weight)),backgroundColor:t.map((e=>e.color)),borderColor:t.map((e=>e.borderColor)),borderWidth:1.3,fill:!1,pointRadius:3,tension:1}]},options:{plugins:{legend:{display:!0},tooltip:{callbacks:{label:function(e){return"Gewichtung: "+e.formattedValue+"%"}}}},animations:{tension:{duration:1e3,easing:"linear",from:.7,to:0,loop:!1}},scales:{r:{ticks:{backdropColor:"transparent"}}},responsive:!0,maintainAspectRatio:!1}})}function y(e){let o=0,a=0;if(Object.values(n).forEach((n=>{n.forEach((n=>{if(n.subjectId===e){const e=t[n.categoryId][0],c=e?parseFloat(e.weight):1;let s=parseFloat(n.value);isNaN(s)||isNaN(c)||(o+=s*c,a+=c)}}))})),0===a)return"0.00";const c=o/a;return document.getElementById(e).setAttribute("data-subject-average",c),c.toFixed(2)}function h(){let t=[],n=0;Object.values(e).forEach((e=>{e.forEach((e=>{const o=document.getElementById(e.id);if(o){const e=o.getAttribute("data-subject-average"),a=Number(e);0!==a&&(t.push(a),n++)}}))}));const o=n>0?t.reduce(((e,t)=>e+t),0)/n:0;document.getElementById("averageMessage").textContent="Ø "+o.toFixed(2)}function b(e,t,o,c){const s=document.getElementsByClassName("categoriesContainer")[0];if(!s)return console.error("Category Container not found");const d=document.createElement("div");d.classList.add("category-box"),d.id=o,d.innerHTML=`\n        <div class="titleContainer">\n            <span id="category-name${o}" class="category-name">${e}</span>\n            <span id="category-weight${o}" class="category-weight">x ${t}</span>\n        </div>\n        <div class="buttonsContainerKategorie">\n        <button class="neuesFachButton" id="createGradeButton${o}">Note hinzufügen <img src="assets/add.svg" alt="+" class="IMG"></button>\n        <button class="neuesFachButton" id="editGradesButton${o}">Bearbeiten <img src="assets/edit.svg" alt="+" class="IMG"></button>\n        </div>\n        <div id="gradesContainer${o}" class="gradesContainer"></div>\n        `,s.appendChild(d),setTimeout((function(){d.classList.add("show")}),20);const i=document.getElementById(`createGradeButton${o}`),u=document.getElementById(`editGradesButton${o}`);i.addEventListener("click",(function(){!function(e,t){f();const n=document.getElementById("neueNotePopup"),o=document.getElementById("neueNotePopup-input"),a=document.getElementById("neueNotePopup-select"),c=(new Date).toISOString().split("T")[0];document.getElementById("neueNotePopup-create").disabled=!1,o.value=c,a.value=3,n.style.display="block",setTimeout((()=>{n.classList.add("show")}),20),n.setAttribute("data-grade-subject-id",e),n.setAttribute("data-grade-category-id",t)}(c,o)})),u.addEventListener("click",(function(){!function(e,t){const o=document.getElementById("category-name"+t).textContent;let c=document.getElementById("category-weight"+t).textContent;c=c.substring(2),f();const s=document.getElementById("editNotePopup");s.style.display="block",setTimeout((()=>{s.classList.add("show")}),20),s.setAttribute("data-category-subject-id",e),s.setAttribute("data-category-category-id",t),document.getElementById("editNotePopup-input").value=o,document.getElementById("editNotePopup-select").value=c;const d=document.getElementById("editNotePopupList");if(!d)return console.error("Grade Container not found");d.innerHTML="",Object.values(n).forEach((n=>{n.forEach((n=>{n.subjectId===e&&n.categoryId===t&&function(e,t,n){const o=document.getElementById("editNotePopupList");if(!o)return console.error("Grade Container not found");const c=document.createElement("div");c.className="gradePopupElement",c.id=n,c.innerHTML=` \n        <div class="gradePopupContainer">\n            <label class="gradePopup">\n                <input type="checkbox" class="gradeCheckbox" id="checkbox-${n}" name="gradeCheckbox">\n                ${t}\n            </label>\n            <span id="gradePopupValue" class="grade">${e}</span>\n        </div>\n    `,o.appendChild(c);const s=c.querySelector(".gradeCheckbox");s.addEventListener("change",(function(){if(this.checked)c.classList.add("selectedGrade"),a.includes(n)||a.push(n);else{c.classList.remove("selectedGrade");const e=a.indexOf(n);e>-1&&a.splice(e,1)}}));const d=c.querySelector(".gradePopupContainer");d.addEventListener("click",(function(e){e.target!==s&&e.target!==d.querySelector("label")&&(s.checked=!s.checked,s.dispatchEvent(new Event("change")))}))}(n.value,n.date,n.id)}))}))}(c,o)}))}function f(){document.querySelectorAll(".popup").forEach((e=>{e.style.display="none"}))}function E(e,o,a){let c;const s=document.getElementsByClassName("subjects-wrapper")[0];if(!s)return console.error("Subject Container not found");const d=document.createElement("div");d.classList.add("subject-box"),d.id=a,d.style.backgroundColor=o;const i=document.createElement("p");i.classList.add("subject-name"),i.textContent=e;const u=document.createElement("p");u.classList.add("subject-average"),u.id="subject-average"+a,u.textContent="0.00",d.addEventListener("click",(function(){!function(e,o){f(),document.getElementById("zurückZurMainPage").setAttribute("category-data-subject-id",e),document.getElementById("mainContent").style.display="none",document.getElementById("subjectContent").style.display="block",document.getElementById("neueKategoriePopup").setAttribute("category-data-subject-id",e),document.getElementById("FachName").textContent=o;const a=document.getElementsByClassName("subject-box");for(let e=0;e<a.length;e++)a[e].classList.remove("show");Object.values(t).forEach((t=>{t.forEach((t=>{t.subjectId===e&&b(t.name,t.weight,t.id,t.subjectId)}))})),Object.values(n).forEach((t=>{t.forEach((t=>{t.subjectId===e&&v(t.value,t.date,t.categoryId,t.id)}))}))}(a,e)})),d.addEventListener("touchstart",(function(e){d.classList.add("pressed"),c=setTimeout((()=>{d.classList.remove("pressed"),function(e,t,n,o,a){e.preventDefault();const c=document.querySelector(".context-menu");c&&(c.classList.remove("show"),setTimeout((function(){c.remove()}),100));const s=`\n        <div class="context-menu" style="position: absolute; top: ${e.touches[0].clientY}px; left: ${e.touches[0].clientX}px;">\n            <button class="popup-buttons" id="EditSubjectContext">Bearbeiten</button>\n            <button class="popup-buttons" id="DeleteSubjectContext">Löschen</button>\n        </div>`;document.body.insertAdjacentHTML("beforeend",s),setTimeout((()=>{document.querySelector(".context-menu").classList.add("show")}),20),document.getElementById("EditSubjectContext").addEventListener("click",(()=>I(t,n))),document.getElementById("DeleteSubjectContext").addEventListener("click",(()=>B(t,a)))}(e,a,o,0,d)}),300)}),{passive:!0}),d.addEventListener("touchend",(function(){clearTimeout(c),d.classList.remove("pressed")})),d.addEventListener("touchmove",(function(){clearTimeout(c),d.classList.remove("pressed")})),d.addEventListener("contextmenu",(function(t){t.preventDefault();const n=document.querySelector(".context-menu");n&&(n.classList.remove("show"),setTimeout((function(){n.remove()}),19));const o=`\n            <div class="context-menu" style="position: absolute; top: ${t.clientY}px; left: ${t.clientX}px;">\n                <button class="popup-buttons" id="EditSubjectContext">Bearbeiten</button>\n                <button class="popup-buttons" id="DeleteSubjectContext">Löschen</button>\n            </div>`;setTimeout((()=>{document.body.insertAdjacentHTML("beforeend",o),document.getElementById("EditSubjectContext").addEventListener("click",(()=>I(a,e))),document.getElementById("DeleteSubjectContext").addEventListener("click",(()=>B(a,d)))}),20),setTimeout((()=>{document.querySelector(".context-menu").classList.add("show")}),40)})),s.appendChild(d),d.appendChild(i),d.appendChild(u),setTimeout((function(){d.classList.add("show")}),20)}function v(e,t,n,o){const a=document.getElementById("gradesContainer"+n);if(!a)return console.error("Grade Container not found");const c=document.createElement("div");c.className="gradeElement",c.id=o,c.innerHTML=` \n        <span id="gradeDate" class="gradeDate grade">${t}</span>\n        <span id="gradeValue" class="gradeValue grade">${e}</span>\n        \n    `,a.appendChild(c),setTimeout((function(){const e=document.getElementsByClassName("gradeDate"),t=document.getElementsByClassName("gradeValue");for(let t=0;t<e.length;t++)e[t].classList.add("show");for(let e=0;e<t.length;e++)t[e].classList.add("show")}),20)}function I(e,t){const n=document.getElementById("editFachPopup"),a=document.getElementById("editFachPopup-input"),c=document.getElementById(e).querySelector(".subject-name").textContent,s=document.querySelector(".context-menu"),d=document.getElementById(e).style.backgroundColor,i=function(e,t,n){const o=e=>e.toString(16).padStart(2,"0");return"#"+o(e)+o(t)+o(n)}(parseInt(d.substring(4,d.indexOf(","))),parseInt(d.substring(d.indexOf(",")+2,d.lastIndexOf(","))),parseInt(d.substring(d.lastIndexOf(",")+2,d.indexOf(")"))));s.classList.remove("show"),setTimeout((function(){s.remove()}),100),n.setAttribute("data-subject-id",e),document.getElementById("editFachPopup-input").value=t;const u=document.querySelectorAll(".color-choice");u.forEach((e=>{e.classList.remove("selected")})),u.forEach((e=>{e.getAttribute("data-color")===i&&e.classList.add("selected")})),o=i,a.value=c,n.style.display="block",setTimeout((()=>{n.classList.add("show")}),20)}function B(e,t){f();const n=document.querySelector(".context-menu");n.classList.remove("show"),setTimeout((function(){n.remove()}),100),t.classList.remove("show"),setTimeout((function(){t.remove(),k(e,"","","delete"),g(),h(),p()}),300)}function C(){const e=document.getElementsByClassName("subject-box");for(;e.length>0;)e[0].parentNode.removeChild(e[0])}function L(){const e=document.getElementsByClassName("category-box");for(;e.length>0;)e[0].parentNode.removeChild(e[0])}function w(){document.getElementsByClassName("FachPopupInput")[0].value="",document.querySelectorAll(".color-choice").forEach((e=>{e.classList.remove("selected")})),o=""}function k(t,n,o,a){const s=Date.now();if("overwrite"===a){const a=e[t].findIndex((e=>e.id===t));-1!==a&&(e[t][a]={id:t,name:n,color:o,action:"overwrite"})}else"delete"===a?e[t]=[{id:t,name:n,color:o,action:"delete"}]:"push"===a&&(e[s]=[{id:s,name:n,color:o,action:"push"}]);"push"!==a&&"overwrite"!==a&&"delete"!==a||(new d).pushSubjects(c)}function j(e,n,o,a,s){const i=Date.now();if("overwrite"===s){const c=t[e].findIndex((t=>t.id===e));-1!==c&&(t[e][c]={id:e,name:n,weight:o,subjectId:a,action:"overwrite"})}else"delete"===s?t[e]=[{id:e,name:n,weight:o,subjectId:a,action:"delete"}]:"push"===s&&(t[i]=[{id:i,name:n,weight:o,subjectId:a,action:"push"}]);"push"!==s&&"overwrite"!==s&&"delete"!==s||(new d).pushCategories(c)}function P(e,t,o,a,s,i){const u=Date.now();if("overwrite"===i){const c=n[e].findIndex((t=>t.id===e));-1!==c&&(n[e][c]={id:e,value:t,date:o,subjectId:a,categoryId:s,action:"overwrite"})}else"delete"===i?n[e]=[{id:e,value:t,date:o,subjectId:a,categoryId:s,action:"delete"}]:"push"===i&&(n[u]=[{id:u,value:t,date:o,subjectId:a,categoryId:s,action:"push"}]);"push"!==i&&"overwrite"!==i&&"delete"!==i||(new d).pushGrades(c)}function x(){const e=document.getElementById("neusFachPopup-input").value,t=""!==o;document.getElementById("neuesFachPopup-create").disabled=!(e&&t)}function N(){const e=document.getElementById("editFachPopup-input").value,t=""!==o;document.getElementById("editFachPopup-save").disabled=!(e&&t)}function S(){document.querySelectorAll(".popup-buttons").forEach((e=>{e.disabled=!0}))}document.addEventListener("DOMContentLoaded",(function(){const t=document.body,n=document.getElementById("darkModeIcon");"true"===function(e){let t={};return document.cookie.split(";").forEach((function(e){let[n,o]=e.split("=");t[n.trim()]=o})),t.darkMode}()?(t.classList.add("dark"),n.src="assets/darkmode.svg"):(t.classList.remove("dark"),n.src="assets/lightmode.svg"),firebase.auth().onAuthStateChanged((function(t){t?(document.getElementById("mainContent").style.display="block",document.getElementById("loginContent").style.display="none",function(t){const n=new s;n.loadSubjects((()=>{n.loadCategories((()=>{n.loadGrades((()=>{C(),L();const t=document.getElementById("noSubjectMessage");0===Object.keys(e).length?t.style.display="block":t.style.display="none",Object.values(e).forEach((e=>{e.forEach((e=>{E(e.name,e.color,e.id);const t=y(e.id);document.getElementById("subject-average"+e.id).textContent=t}))})),h(),g(),p()}),t)}),t)}),t)}(t.uid),c=t.uid):(console.log("Kein Benutzer angemeldet."),document.getElementById("mainContent").style.display="none",document.getElementById("loginContent").style.display="block")})),x(),S(),document.addEventListener("click",(function(e){const t=document.querySelector(".context-menu");t&&!t.contains(e.target)&&(t.classList.remove("show"),setTimeout((function(){t.remove()}),100))})),document.querySelectorAll(".color-choice").forEach((e=>{e.addEventListener("click",(()=>{return t=e,document.querySelectorAll(".color-choice").forEach((e=>{e.classList.remove("selected")})),t.classList.add("selected"),o=t.getAttribute("data-color"),void x();var t}))})),document.getElementById("neuesFachButtonClick").addEventListener("click",(function(){f();const e=document.getElementById("neuesFachPopup");document.getElementById("neusFachPopup-input").value="",e.style.display="block",setTimeout((()=>{e.classList.add("show")}),20),S()})),document.getElementById("neuesFachPopup-cancel").addEventListener("click",(function(){const e=document.getElementById("neuesFachPopup");e.classList.remove("show"),setTimeout((function(){e.style.display="none"}),100),w(),S()})),document.getElementById("neuesFachPopup-create").addEventListener("click",(function(){const e=document.getElementById("neuesFachPopup"),t=document.getElementById("noSubjectMessage"),n=document.getElementById("neusFachPopup-input").value;""!==n&&(k("",n,o,"push"),e.style.display="none",t.style.display="none",w(),S())})),document.getElementById("editFachPopup-cancel").addEventListener("click",(function(){const e=document.getElementById("editFachPopup");e.classList.remove("show"),setTimeout((function(){e.style.display="none"}),100),w(),S()})),document.getElementById("editFachPopup-save").addEventListener("click",(function(){const e=document.getElementById("editFachPopup"),t=document.getElementById("editFachPopup-input").value,n=o,a=e.getAttribute("data-subject-id"),c=document.getElementById(a);""!==t&&(k(a,t,n,"overwrite"),e.style.display="none",c.style.backgroundColor=n,m(c.getElementsByClassName("subject-name")[0],t),w(),S(),p())})),document.getElementById("neueKategorieButtonClick").addEventListener("click",(function(){f();const e=document.getElementById("neueKategoriePopup"),t=document.getElementById("neueKategoriePopup-input"),n=document.getElementById("neueKategoriePopup-select");t.value="",n.value=1,e.style.display="block",setTimeout((()=>{e.classList.add("show")}),20),S()})),document.getElementById("zurückZurMainPage").addEventListener("click",(function(){const e=this.getAttribute("category-data-subject-id");f(),document.getElementById("mainContent").style.display="block",document.getElementById("subjectContent").style.display="none",L(),S(),g();const t=y(e);document.getElementById("subject-average"+e).textContent=t,h(),p();const n=document.getElementsByClassName("subject-box");for(let e=0;e<n.length;e++)n[e].classList.add("show")})),document.getElementById("neueKategoriePopup-cancel").addEventListener("click",(function(){const e=document.getElementById("neueKategoriePopup");e.classList.remove("show"),setTimeout((function(){e.style.display="none"}),100),S()})),document.getElementById("neueKategoriePopup-create").addEventListener("click",(function(){const e=document.getElementById("neueKategoriePopup"),t=document.getElementById("neueKategoriePopup-input").value,n=document.getElementById("neueKategoriePopup-select").value,o=e.getAttribute("category-data-subject-id");""!==t&&(j("",t,n,o,"push"),e.style.display="none",S())})),document.getElementById("neueNotePopup-cancel").addEventListener("click",(function(){const e=document.getElementById("neueNotePopup");e.classList.remove("show"),setTimeout((function(){e.style.display="none"}),100),S()})),document.getElementById("neueNotePopup-create").addEventListener("click",(function(){const e=document.getElementById("neueNotePopup"),t=document.getElementById("neueNotePopup-select").value,n=document.getElementById("neueNotePopup-input").value,o=e.getAttribute("data-grade-subject-id"),a=e.getAttribute("data-grade-category-id");""!==n&&(P("",t,n,o,a,"push"),e.style.display="none",S())})),document.getElementById("editNotePopup-cancel").addEventListener("click",(function(){const e=document.getElementById("editNotePopup"),t=document.getElementById("Notetrashcan-button");e.classList.remove("show"),setTimeout((function(){e.style.display="none"}),100),t.classList.remove("checked"),a=[],S()})),document.getElementById("editNotePopup-save").addEventListener("click",(function(){const e=document.getElementById("editNotePopup"),t=document.getElementById("editNotePopup-input").value,n=e.getAttribute("data-category-subject-id"),o=e.getAttribute("data-category-category-id"),c=document.getElementById("Notetrashcan-button");""!==t&&(function(e,t){const n=document.getElementById("editNotePopup-input").value,o=document.getElementById("editNotePopup-select").value,c=document.getElementById("Notetrashcan-button"),s=document.getElementById("category-name"+e),d=document.getElementById("category-weight"+e);if(m(s,n),m(d,"x "+o),a.length>0&&a.forEach((e=>{const t=document.getElementById(e),n=t.querySelector(".gradeDate"),o=t.querySelector(".gradeValue");n.classList.remove("show"),o.classList.remove("show"),setTimeout((function(){t.remove()}),120),P(e,"","","","","delete"),a=[]})),c.classList.contains("checked")){const t=document.getElementById(e);t.classList.remove("show"),setTimeout((function(){t.remove()}),180),j(e,"","","","delete")}else j(e,n,o,t,"overwrite")}(o,n),e.classList.remove("show"),setTimeout((function(){e.style.display="none"}),100),c.classList.remove("checked"),S())})),document.getElementById("neusFachPopup-input").addEventListener("input",x),document.getElementById("editFachPopup-input").addEventListener("input",N),document.getElementById("neueKategoriePopup-input").addEventListener("input",(function(){const e=document.getElementById("neueKategoriePopup-create"),t=document.getElementById("neueKategoriePopup-input").value;e.disabled=!t})),document.getElementById("neueNotePopup-input").addEventListener("input",(function(){const e=document.getElementById("neueNotePopup-create"),t=document.getElementById("neueNotePopup-input").value;e.disabled=!t})),document.getElementById("editNotePopup-input").addEventListener("input",(function(){const e=document.getElementById("editNotePopup-save"),t=document.getElementById("editNotePopup-input").value;e.disabled=!t})),document.getElementById("Notetrashcan-button").addEventListener("click",(function(e){this.classList.toggle("checked")})),document.getElementById("loginButton").addEventListener("click",i),document.getElementById("logoutButton").addEventListener("click",u),document.getElementById("darkMode").addEventListener("click",(function(){const e=document.body,t=document.getElementById("darkModeIcon");e.classList.contains("dark")?(e.classList.remove("dark"),t.src="assets/lightmode.svg",document.cookie="darkMode=false; path=/; max-age=31536000"):(e.classList.add("dark"),t.src="assets/darkmode.svg",document.cookie="darkMode=true; path=/; max-age=31536000")}))}))})();